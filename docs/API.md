# üìö API —Å–ø–µ—Ü–∏—Ñ–∏–∫–∞—Ü–∏—è Wave Studio

## –û—Å–Ω–æ–≤–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è

- **–ë–∞–∑–æ–≤—ã–π URL**: `http://localhost:5000/api`
- **–í–µ—Ä—Å–∏—è**: 1.0.0
- **–ü—Ä–æ—Ç–æ–∫–æ–ª**: HTTP/REST
- **–û—Ç–≤–µ—Ç—ã**: JSON
- **–ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è**: JWT Bearer Token

## –ß–∏—Å–ª–µ–Ω–Ω—ã–µ –∫–æ–¥—ã –æ—Ç–≤–µ—Ç–æ–≤

| –ö–æ–¥ | –û–ø–∏—Å–∞–Ω–∏–µ |
|-------|----------------------|
| 200 | OK - –£—Å–ø–µ—à–Ω–æ |
| 201 | Created - –ù–æ–≤—ã–π —Ä–µ—Å—É—Ä—Å —Å–æ–∑–¥–∞–Ω |
| 400 | Bad Request - –û—à–∏–±–∫–∞ –≤ –∑–∞–ø—Ä–æ—Å–µ |
| 401 | Unauthorized - –ù–µ–∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω |
| 403 | Forbidden - –ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ —Ö—É |
| 404 | Not Found - –ù–µ –Ω–∞–π–¥–µ–Ω–æ |
| 409 | Conflict - –ö–æ–Ω—Ñ–ª–∏–∫—Ç –¥–∞–Ω–Ω—ã—Ö |
| 500 | Internal Server Error - –û—à–∏–±–∫–∞ —Å–µ—Ä–≤–µ—Ä–∞ |

---

## –ú–æ–¥—É–ª–∏ API

### 1. –ê–≤—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è (`/auth`)

#### –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –∞–¥–º–∏–Ω–∞
**POST** `/auth/register`

**–¢–µ–ª–æ –∑–∞–ø—Ä–æ—Å–∞:**
```json
{
  "username": "newadmin",
  "password": "SecurePass123",
  "email": "admin@example.com"
}
```

**–û—Ç–≤–µ—Ç (201):**
```json
{
  "message": "–û—Ç–ª–∏—á–Ω–æ! –ê–∫–∫–∞—É–Ω—Ç —Å–æ–∑–¥–∞–Ω.",
  "user": {
    "id": 1,
    "username": "newadmin",
    "email": "admin@example.com",
    "role": "admin"
  }
}
```

#### –ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è
**POST** `/auth/login`

**–¢–µ–ª–æ –∑–∞–ø—Ä–æ—Å–∞:**
```json
{
  "username": "admin",
  "password": "Admin123456"
}
```

**–û—Ç–≤–µ—Ç (200):**
```json
{
  "message": "–£—Å–ø–µ—à–Ω–∞—è –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è",
  "token": "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...",
  "user": {
    "id": 1,
    "username": "admin",
    "role": "admin"
  }
}
```

---

### 2. –ö–ª–∏–µ–Ω—Ç—ã (`/clients`)

#### –ü–æ–ª—É—á–∏—Ç—å –≤—Å–µ—Ö –∫–ª–∏–µ–Ω—Ç–æ–≤
**GET** `/clients`

**–û—Ç–≤–µ—Ç (200):**
```json
{
  "success": true,
  "data": [
    {
      "id": 1,
      "full_name": "–ê–ª–µ–∫—Å–∞–Ω–¥—Ä–∞ –ü–µ—Ç—Ä–æ–≤–∞",
      "phone_number": "+79991234567",
      "messenger_link": "https://vk.com/alexandra.petrova",
      "active_subscriptions": [5, 7]
    }
  ],
  "total": 1
}
```

#### –°–æ–∑–¥–∞—Ç—å –∫–ª–∏–µ–Ω—Ç–∞
**POST** `/clients`

**–¢–µ–ª–æ –∑–∞–ø—Ä–æ—Å–∞:**
```json
{
  "full_name": "–ú–∞—Ä–∏—è –û—Ä–ª–æ–≤–∞",
  "phone_number": "+79999876543",
  "messenger_link": "https://t.me/maria_orlova"
}
```

**–û—Ç–≤–µ—Ç (201):**
```json
{
  "success": true,
  "message": "–ö–ª–∏–µ–Ω—Ç —Å–æ—Ö—Ä–∞–Ω–µ–Ω",
  "data": {
    "id": 2,
    "full_name": "–ú–∞—Ä–∏—è –û—Ä–ª–æ–≤–∞",
    "phone_number": "+79999876543",
    "messenger_link": "https://t.me/maria_orlova",
    "active_subscriptions": []
  }
}
```

#### –û–±–Ω–æ–≤–∏—Ç—å –∫–ª–∏–µ–Ω—Ç–∞
**PUT** `/clients/:id`

**–¢–µ–ª–æ –∑–∞–ø—Ä–æ—Å–∞:**
```json
{
  "phone_number": "+79999876544"
}
```

#### –£–¥–∞–ª–∏—Ç—å –∫–ª–∏–µ–Ω—Ç–∞
**DELETE** `/clients/:id`

---

### 3. –¢—Ä–µ–Ω–µ—Ä—ã (`/trainers`)

#### –ü–æ–ª—É—á–∏—Ç—å –≤—Å–µ—Ö —Ç—Ä–µ–Ω–µ—Ä–æ–≤
**GET** `/trainers`

#### –°–æ–∑–¥–∞—Ç—å —Ç—Ä–µ–Ω–µ—Ä–∞
**POST** `/trainers`

**–¢–µ–ª–æ –∑–∞–ø—Ä–æ—Å–∞:**
```json
{
  "full_name": "–ò–≤–∞–Ω –°–∏–¥–æ—Ä–æ–≤",
  "specialization": "—Å–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–π —Ç–∞–Ω–µ—Ü",
  "phone_number": "+79991234568"
}
```

---

### 4. –ê–±–æ–Ω–µ–º–µ–Ω—Ç—ã (`/subscriptions`)

#### –ü–æ–ª—É—á–∏—Ç—å –∞–±–æ–Ω–µ–º–µ–Ω—Ç—ã –∫–ª–∏–µ–Ω—Ç–∞
**GET** `/subscriptions?client_id=1`

#### –°–æ–∑–¥–∞—Ç—å –∞–±–æ–Ω–µ–º–µ–Ω—Ç
**POST** `/subscriptions`

**–¢–µ–ª–æ –∑–∞–ø—Ä–æ—Å–∞ (–õ–∏–º–∏—Ç–∏—Ä–æ–≤–∞–Ω–Ω—ã–π):**
```json
{
  "client_id": 1,
  "type": "limited",
  "price": 3000,
  "total_sessions": 8,
  "start_date": "2025-12-16"
}
```

**–¢–µ–ª–æ –∑–∞–ø—Ä–æ—Å–∞ (–ë–µ–∑–ª–∏–º–∏—Ç–Ω—ã–π):**
```json
{
  "client_id": 1,
  "type": "unlimited",
  "price": 5000,
  "start_date": "2025-12-16"
}
```

---

### 5. –¢—Ä–µ–Ω–∏—Ä–æ–≤–∫–∏ (`/sessions`)

#### –ü–æ–ª—É—á–∏—Ç—å –ø–∞—Å–ø–æ—Ä—Ç —Ç—Ä–µ–Ω–∏—Ä–æ–≤–æ–∫
**GET** `/sessions?date=2025-12-16&trainer_id=1`

#### –°–æ–∑–¥–∞—Ç—å —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫—É
**POST** `/sessions`

**–¢–µ–ª–æ –∑–∞–ø—Ä–æ—Å–∞:**
```json
{
  "trainer_id": 1,
  "date_time": "2025-12-16T19:00:00+06:00",
  "timezone": "UTC+6",
  "clients": [1, 2, 3],
  "subscription_used": [5, 5, 7],
  "notes": "–•–æ—Ä–æ—à–µ–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω–∏–µ"
}
```

**–û—Ç–≤–µ—Ç (201):**
```json
{
  "success": true,
  "message": "–¢—Ä–µ–Ω–∏—Ä–æ–≤–∫–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∞",
  "data": {
    "id": 1,
    "trainer_id": 1,
    "date_time": "2025-12-16T19:00:00+06:00",
    "clients": [1, 2, 3],
    "income_calculated": {
      "total": 2025,
      "by_client": [675, 675, 675]
    }
  }
}
```

---

### 6. –û—Ç—á—ë—Ç—ã (`/reports`)

#### –ü–æ–ª—É—á–∏—Ç—å –æ—Ç—á—ë—Ç –ø–æ —Ç—Ä–µ–Ω–µ—Ä—É
**GET** `/reports/trainer?trainer_id=1&date_from=2025-12-01&date_to=2025-12-31&format=json`

**–û—Ç–≤–µ—Ç (200, format=json):**
```json
{
  "success": true,
  "data": {
    "trainer_id": 1,
    "trainer_name": "–ò–≤–∞–Ω –°–∏–¥–æ—Ä–æ–≤",
    "period": "2025-12-01 to 2025-12-31",
    "sessions_count": 15,
    "total_income": 10125,
    "sessions": [
      {
        "date": "2025-12-16",
        "clients_count": 3,
        "income": 2025
      }
    ]
  }
}
```

#### –ù–∞ –≤—ã–±–æ—Ä —Ñ–æ—Ä–º–∞—Ç–∞
- `format=json` - JSON
- `format=csv` - CSV –¥–ª—è Excel
- `format=pdf` - PDF –¥–æ–∫—É–º–µ–Ω—Ç
- `format=html` - HTML —Ç–∞–±–ª–∏—Ü–∞

**–í—ã–ø–∏—Å–∫–∞ –≤ CSV:**
```
trainer_id,trainer_name,date,clients_count,income
1,–ò–≤–∞–Ω –°–∏–¥–æ—Ä–æ–≤,2025-12-16,3,2025
```

#### –û—Ç—á—ë—Ç –ø–æ –∫–ª–∏–µ–Ω—Ç—É
**GET** `/reports/client?client_id=1&date_from=2025-12-01&date_to=2025-12-31&format=json`

#### –û—Ç—á—ë—Ç –ø–æ –¥–∞—Ç–µ —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫–∏
**GET** `/reports/date?date=2025-12-16&format=json`

---

## –û—à–∏–±–∫–∏ –∏ –í–∞–ª–∏–¥–∞—Ü–∏—è

### –ù–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ
**–û—Ç–≤–µ—Ç (400):**
```json
{
  "success": false,
  "error": {
    "message": "–ù–µ –≤–∞–ª–∏–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ",
    "details": [
      {
        "field": "phone_number",
        "message": "–ù–æ–º–µ—Ä —Ç–µ–ª–µ—Ñ–æ–Ω–∞ –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –≤ —Ñ–æ—Ä–º–∞—Ç–µ +7XXXXXXXXXX"
      }
    ]
  }
}
```

### –ù–µ–∞–≤—Ç–æ—Ä–∏–∑–µ–¥ (–Ω–µ—Ç –ø—Ä–∞–≤)
**–û—Ç–≤–µ—Ç (401):**
```json
{
  "success": false,
  "error": {
    "message": "–ù–µ–∞–≤—Ç–æ—Ä–∏–∑–∏—Ä–æ–≤–∞–Ω",
    "code": "UNAUTHORIZED"
  }
}
```

### –ö–æ–Ω—Ñ–ª–∏–∫—Ç (–Ω–∞–ø—Ä–∏–º–µ—Ä, –ø–µ—Ä–µ–∫—Ä—ã—Ç–∏–µ —Ç—Ä–µ–Ω–∏—Ä–æ–≤–æ–∫)
**–û—Ç–≤–µ—Ç (409):**
```json
{
  "success": false,
  "error": {
    "message": "–ö–æ–Ω—Ñ–ª–∏–∫—Ç: –∫–ª–∏–µ–Ω—Ç —É–∂–µ –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω –Ω–∞ –¥—Ä—É–≥—É—é —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫—É –≤ —ç—Ç–æ –≤—Ä–µ–º—è",
    "code": "SESSION_CONFLICT"
  }
}
```

### –ö–ª–∏–µ–Ω—Ç —Å –ø—Ä–æ—Å—Ä–æ—á–µ–Ω–Ω—ã–º/–æ—Ç—Å—É—Ç—Å—Ç–≤—É—é—â–∏–º –∞–±–æ–Ω–µ–º–µ–Ω—Ç–æ–º
**–û—Ç–≤–µ—Ç (409):**
```json
{
  "success": false,
  "error": {
    "message": "–ö–ª–∏–µ–Ω—Ç –Ω–µ –∏–º–µ–µ—Ç –∞–∫—Ç–∏–≤–Ω—ã—Ö –∞–±–æ–Ω–µ–º–µ–Ω—Ç–æ–≤ –¥–ª—è —ç—Ç–æ–π —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫–∏",
    "code": "NO_ACTIVE_SUBSCRIPTION"
  }
}
```

---

## –ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

### cURL

**–ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è:**
```bash
curl -X POST http://localhost:5000/api/auth/login \
  -H "Content-Type: application/json" \
  -d '{"username": "admin", "password": "Admin123456"}'
```

**–û–ø—Ç—Ä–∞–≤–∫–∞ —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫–∏:**
```bash
curl -X POST http://localhost:5000/api/sessions \
  -H "Content-Type: application/json" \
  -H "Authorization: Bearer <TOKEN>" \
  -d '{
    "trainer_id": 1,
    "date_time": "2025-12-16T19:00:00+06:00",
    "timezone": "UTC+6",
    "clients": [1, 2, 3],
    "subscription_used": [5, 5, 7]
  }'
```

---

## –ü—Ä–∏–º–µ—á–∞–Ω–∏—è

- –í—Å–µ –¥–∞—Ç—ã/–≤—Ä–µ–º—è –≤ ISO 8601 —Å timezone
- JWT —Ç–æ–∫–µ–Ω —Å—Ä–æ–∫ –¥–µ–π—Å—Ç–≤–∏—è: 7 –¥–Ω–µ–π
- –í—Å–µ —Ç–µ–ª–∞ –∑–∞–ø—Ä–æ—Å–æ–≤ –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å –≤ JSON
- –ü–∞—Å—Å—ã –≤—Å–µ–≥–¥–∞ –≤ –≤–∏–¥–µ bcrypt —Ö–µ—à–µ–π

